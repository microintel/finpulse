<!DOCTYPE html>
<html>
<head>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="icon" type="image/png" href="black.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href='https://fonts.googleapis.com/css?family=Economica' rel='stylesheet'>

<style type="text/css">
  .swal2-input {
    width: 93% !important;
    box-sizing: border-box;
    margin:0px; 
  }
  .recbor{
  margin:0px;
  padding:3px;
  display:flex;
  flex-direction:column;
  width:98%;
  gap:10px;
  }
  .reciv{
 /* background-color:#2E7D32; */
 border:2px solid #2E7D32;
 color:#2E7D32;
 padding:3px;
 margin:0px;
 border-radius:7px;
 
  }
  .borlend{
  border:2px solid #C62828;
  color:#C62828;
  margin:0px;
  padding:3px;
  border-radius:7px;
  }
  .rechead,.borhead{
   display:flex;
   width:98%;
   justify-content:space-between;
   border-bottom:1px dashed grey;
   margin:0px;
   padding:1px;
  }
  .rechead div h4,.borhead div h4{
  display:flex;
  width:98%;
  justify-content:space-evenly;
  }
  .rechead button,.borhead button,.rechead font,.borhead font{
  max-width:24%;
  height:1.5rem;
  min-width:20%;
  
  }
  .rechead input,.borhead input{
  height:0.5rem;
  max-width:24%;
  min-width:20%;
  }
  
  .recdata,.bordata{
  display:flex;
  width:100%;
  flex-direction:column;
  justify-content:space-evenly;
  padding:5px;
  gap:7px;
  font-size:0.8rem;
  }
  .recdata div,.bordata div{
  display:flex;
  width:100%;
  justify-content:space-evenly;
  gap:7px;
  text-align:center;
  border-bottom:1px solid grey;
  }
  
  .recdata div:hover ,.bordata div:hover{
  
  background-color:#e3e3e3;
  }
  
  .lmode,.lmodes{
  text-align:center;
  padding:3px;
  }
  .lmo,.bor{
  
  font-weight:bold;
  font-size:1.1rem;
  }
  .lmodes{
  border-right:2px solid black;
  color: orange;
  font-weight:bold;
  }
  
  .borhead h4,.rechead h4{
  margin:0px;
  padding:0px;
  display:flex;
  max-width:98%;
  min-width:90%;
  gap:5px;
  justify-content:space-between;
  align-items:center;
  }
  .lmo.bor{
  color:red;
  }
  
  .recab,.recinp{
  background-color:#2E7D32;
  border:0px solid #2E7D32;
  color:var(--back);
  border-radius:7px;
  }
  .borab,.borinp{
  background-color:#C62828;
  border:0px solid #C62828;
  color:var(--back);
  border-radius:7px;
  }
  .borinp::placeholder,.recinp::placeholder{
  color:var(--white);
  }
  
  .addran{
  
  background-color:var(--back);
  border:1.5px solid var(--bor);
  border-radius:7px;
  margin:0px;
  color:brown;
  }
  #linebal{
    margin:0px;
    padding:5px;
  }

  #grpsel{
    background-color: var(--back);
    color: var(--b);
    border-radius: 6px;
    margin: 5px;
    padding: 10px;
    max-width: fit-content;
    display:none;
  }

  .fa-plus{
    color:red;
    align-items: center;
    font-size: 1.3rem;
  }

  #txnTbl{
    margin: 10px;
    
  }

    .expcate{
      
      margin:8px;
      border-collapse: collapse;
      width: 90%;
      background-color: var(--w);
      border-radius: 7px;
        }
    .expcate tbody tr td , .expcate thead tr th{
      border: 1.5px solid var(--b);
      padding: 10px;
      margin: 3px;
      
    }
    .expcate thead tr th{
      background-color: var(--b);
      color: var(--w);
    }

    #catdets{
      display:none;
      flex-direction: column;
      justify-content: space-around;
      align-items: center;
      color: var(--b);
      margin: 10px;
      padding: 10px;
    }
    .head{
      width: 90%;
      display: flex;
      justify-content: space-between;
      align-items: center;

    }

    .head span{
      font-size: 1.1rem;
      color: var(--b);
    }

    .head i{
      font-size: 1.3rem;
      color: red;
    }

    #sumTbl{
      margin: 10px;
      border:0px solid black;
      width: 95%;
      display:none;
      flex-direction: column;
      justify-content: space-around;
      align-items: center;
      
    }
  #sumTbl table{
    border-collapse: collapse;
    border: 1px solid var(--bor);
    margin: 10px;
  }
    #sumTbl table thead{
       border: 1px solid var(--bor);
       background-color: var(--b);
       color: var(--w);
       
    }

    #sumTbl table thead tr th{
padding: 10px;
    }

    #sumTbl table tbody tr td{
    background-color: var(--w);
    columns: var(--b);
    }

    #sumTbl table tbody tr td:hover, .expcate tbody tr td:hover{
      background-color: #3b2f60; 
    }
    
    
    #pwInput {
    font-size: 16px;
    padding: 10px;
    border: 2px solid grey;
    border-radius: 8px;
    outline: none;
    margin:10px;
    }
    
#cccbo{

color:#C84848;
}

#cccbo {
  width: 18px;
  height: 18px;
  accent-color: #4caf50;
}

html {
  scroll-behavior: smooth;
}

#resnk{

margin:3px;
}

#cascc tr td{

border:0.7px solid grey;
}

#cascc tr td:first-child{
border-left:0px solid grey;
}

#cascc tr td:last-child{
border-right:0px solid grey;
}

#nknb h3{

margin:0px;
}

.fa-times{

color:var(--exp);
font-size:1.3rem;

}


ul ul {
display:none;
  position: absolute;
  width:100%;
  top:136px;
  left: 150px;
  background:var(--w);
  padding: 10px;
  border: 1px solid var(--b);
}


ul ul li:last-child{
border:none;
}


#boxxx {
      width: 60px;
      height: 60px;
      background-color:var(--b);
      color: var(--w);
      display: flex;
      align-items: center;
      justify-content: center;
      position:fixed;
      bottom: 10px;
      font-size:2rem;
      right: 3px;
      z-index:1000;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    }
    .btnn-group{
    display:flex;
    width:100%;
    flex-direction:column;
    justify-content:flex-start;
    gap:10px;
    align-items:flex-start;
    }
    .btnn-group button  {
    display:flex;
    justify-content:flex-start;
    align-items:center;
    margin: px;
    gap:10px;
    background-color:transparent;
    padding: 1px 10px;
    font-size:1.1rem;
    color:black;
    text-align:center;
    border-radius:10px;
    border:none;
    }
    
    .btnn-group button i{
    
    font-size:2rem;
    color:black;
    
    }
    
    .dsert{
    display:flex;
    width:90%;
    justify-content:space-between;
    
    }
    
    .dsert input,.dsert button{
    width:fit-content;
    background-color:var(--w);
    color:var(--b);
    border:2px solid var(--bor);
    border-radius:7px;
    }
    
   .optbut .tingle-modal-box {
   background:var(--back);
   border-radius: 14px;
   padding: 16px;
   box-shadow: 0 6px 20px rgba(0, 0, 0, 0.18);
   width: 92%;
   max-width: 360px;
   margin: 20px auto;
   }
   
   .optbut h2 {
   font-family: 'Segoe UI', sans-serif;
   font-size: 1.4rem;
   font-weight: 600;
   margin-bottom: 14px;
   color:  var(--b);
   text-align: center;
   border-bottom: 1px solid #eee;
   padding-bottom: 8px;
   }
   
   .optbut .btnn-group {
   display: flex;
   flex-direction: column;
   gap: 10px;
   }
   
   .optbut .btnn-group button {
   background: #4facfe;
   background: linear-gradient(135deg, #4facfe, #00f2fe);
   color: #fff;
   border: none;
   padding: 10px 12px;
   font-size: 0.95rem;
   border-radius: 8px;
   cursor: pointer;
   text-align: left;
   display: flex;
   align-items: center;
   gap: 8px;
   font-family: 'Segoe UI', sans-serif;
   transition: all 0.25s ease;
   box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
   }
   
   .optbut .btnn-group button:hover {
   background: linear-gradient(135deg, #43e97b, #38f9d7);
   transform: translateY(-1px);
   box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
   }
   
   .optbut .btnn-group button i {
   font-size: 1.1rem;
   }
    
    @keyframes appear {
        from {
          opacity: 0;
          
          clip-path: inset(0% 30% 30% 30%);
        }
        to {
          opacity: 1;
        
          clip-path: inset(0 0 0 0);
        }
      }

      .child {
        animation: appear linear;
        animation-timeline: view();
        transition: animation 1s ease;
        transition: box-shadow 1s ease;
        animation-range: entry 0% cover 12%;
    }
    
    #curveMenu {
    position: fixed;
    bottom: 16px;
    right: 16px;  
    left: auto;
    width: 60px;
    height: 60px;
    z-index: 5000;
    }
    
    #curveToggle {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: var(--b);
    color: var(--w);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.6rem;
    cursor: pointer;
    user-select: none;
    touch-action: manipulation;
    box-shadow: grey 0px 1px 4px;
    }
    
    .curve-item {
    position: absolute;
    bottom: 7px;
    left: 7px;
    width: 46px;
    height: 46px;
    border-radius: 50%;
    border: none;
    background: var(--b);
    color: var(--w);
    font-size: 1.1rem;
    opacity: 0;
    pointer-events: none;
    transform: translate(0,0);
    transition: transform 0.35s ease, opacity 0.25s ease;
    }
    
    #curveMenu.open .curve-item {
    opacity: 1;
    pointer-events: auto;
    }
    
    #curveMenu.open .curve-item:nth-of-type(1) {
    transform: translate(20px, -90px);
    }
    
    #curveMenu.open .curve-item:nth-of-type(2) {
    transform: translate(-30px, -70px);
    }
    
    #curveMenu.open .curve-item:nth-of-type(3) {
    transform: translate(-70px, -30px);
    }
    
    #curveMenu.open .curve-item:nth-of-type(4) {
    transform: translate(-80px, 20px);
    }
    
    #curveMenu.open .curve-item:nth-of-type(5) {
    transform: translate(-100px, -100px);
    }
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tingle.js@0.15.3/dist/tingle.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/tingle.js@0.15.3/dist/tingle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
<script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
<script src="https://unpkg.com/draggabilly@3/dist/draggabilly.pkgd.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pretty-checkbox@3.0/dist/pretty-checkbox.min.css" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> BlackRoad</title>
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="finpulse.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

</head>
<body>

<div id="curveMenu">
  <div id="curveToggle">
    <i class="bi bi-gear"></i>
  </div>

  <button class="curve-item" onclick="togPar()">
  <i class="bi bi-book"></i>
  </button>
  
  
  
  
  <button class="curve-item" onclick="exportToCSV()">
  <i class="bi bi-filetype-csv"></i>
  </button>
  
  <button class="curve-item" onclick="theame(this.id)" id="w">
  <i id="ttte" class="fa-solid fa-palette"></i>
  </button>
  
  <button class="curve-item" onclick="togSRC()">
  <i class="bi bi-search"></i>
  </button>
  
  <button class="curve-item" onclick="stTOP()">
  <i class="bi bi-chevron-double-up"></i>
  </button>
  
</div>

<i id="boxxx" style="display:none;" class="fa-solid fa-file-csv"></i>


<div class="menu" id="mmmm">

<div class="om">
  <img width="30px" style="" id="mimg" src="https://img.icons8.com/?size=100&id=36389&format=png&color=FFFFFF">
    <ul class="feed ani-li">
      <li onclick="profDis()" id="acNa"> <i class="fas fa-user"></i> Profile</li>
      
      <li class="cnrr" onclick="appendC()"> <i class="fas fa-plus-circle"></i> New Record</li>
      <li onclick="location.href='frotu.html'"> <i class="fas fa-gift"></i> Frotu</li>
      <li onclick="location.href='recbor.html'"> <i class="fas fa-hand-holding-usd"></i> Lend </li>
       <li onclick="nknsu()"> <i class="fas fa-file-alt"></i> Summary </li>
        <ul class="ani-li" id="sumidd">
          <li onclick="disexpppp('flex')"> <i class="fas fa-wallet"></i> SRC Summary</li>
          <li onclick="nknv()"> <i class="fas fa-random"></i> Dispersion</li>
          <li onclick="disexpp('flex')"> <i class="fas fa-receipt"></i> Exp Summary </li>
          <li onclick="grpse('block')"> <i class="fas fa-chart-bar"></i> Graph Ex/bal</li>
        </ul>
        
      <li onclick="location.href='accounting.html'"> <i class="fas fa-calculator"></i> Accounting </li>
      <li onclick="location.href='Aggreement/agg.html'"> <i class="fas fa-file-signature"></i> Aggreement </li>
      <li onclick="location.href='buff/note.html'" id="buffet" style="display:none;"> <i class="fas fa-archive"></i> Buffet </li>
      <li onclick="showTingle()"> <i class="fas fa-ellipsis-h"></i> Other </li>
        </ul>
  </div>
  
  <img id="tttim" width="160px" height="35px" src="blk.gif">

<div id="yyyy" style="display:block;" class="theame">
  <img onclick="location.href='chat/chat.html'" id="w" style="display:block;" class="nknth" src="https://img.icons8.com/color/48/chat--v1.png">
  
  </div>

</div>

<center><h2 style="text-align:left;" id="adapa"> BlackRoad</h2></center>


<div style="display:none;" class="bsea">
<a href="#sinpp">&#x1F50D</a>
</div>


  <div id="ssinp" class="sinp">
  
  <input type="text" id="sinpp" placeholder="Amount &#x1F50D ..." oninput="searTa()" />
        
        <input type="text" id="seait" placeholder="Tran &#x1F50D ..." oninput="sea()" />
        
       </div> 

      <center>
        
        
        <div style="display:none;" id="alllvr" class="alver">
        <details open="true">
        <summary style="color:var(--b);"> Accounting </summary>
        
        <table>
        
        <tr>
        <th class="accttab" style="padding:10px;border-bottom:1px solid var(--bor);">Lend Amt</th>
        <th class="accttab" style="padding:10px;border-bottom:1px solid var(--bor);">Bank Bal</th>
        <th class="accttab" style="padding:10px;border-bottom:1px solid var(--bor);">OTH</th>
        </tr>
        
        <tr >
        <td class="accttab"><input oninput="alve()" value="0" id="lenI"></td>
        <td class="accttab"><input oninput="alve()" value="0" id="bnkI"></td>
        <td class="accttab"><input oninput="alve()" value="0" id="oth"></td>
        </tr>
        
        <tr>
        <td class="accttab" colspan="3"><textarea oninput="alve()" id="texta">0</textarea></td>
        </tr>
        <tr>
        <td class="accttab" style="color:orange;font-size:22px;font-family:'Economica';" id="alvvs">0</td>
        <td class="accttab" style="color:lightgreen;font-size:26px;font-family:'Economica';" id="evesum">0</td>
        <td class="accttab" style="color:aqua;font-family:'Economica';font-size:22px;" id="texsum">0</td>
        </tr>
        <tr>
        <td colspan="3"><h4 id="finalAc"> </h4></td>
        </tr>
        </table>
        
        </details>
        </div>
        <div id="resnk"></div>

          <div id="sumTbl">
            
          </div>

    <div style="display:none;margin:0px;padding:0px;" class="dsert" id="ddsert">
      <input id="frd" type="date" value="2025-05-01"><input id="tod" type="date" value="2025-05-05"><button onclick="filbydate('frd','tod','dateColumn')"> Filter</div>
    </div>
       <div id="catdets">
         <div class="head">
          <i onclick="shfei('catdets')" class="fa-solid fa-share njk" style="color:lightgreen;display:none;"></i>
          <span> Expences Category </span>
          <i onclick="disexpp('none')" class="fa fa-times"></i>
          
         </div><br>
         <div class="pretty p-default p-round">
         <input onchange="hiexpcat(this)" type="checkbox" />
         <div class="state">
         <label id="cheklab">hide all Category</label>
         </div>
         </div>
       </div>
       </center>

 

   
   <div style="display:none;" id="borwi" class="borw">
   <div class="canh">
   <h4 style="margin:0px;padding:0px;color:transparent;">B</h4>
   <center>
   <h4 style="margin:0px;padding:0px;color:var(--b)"> Recivables / Borrowing</h4>
   </center>
   <p id="canb" style="padding:0px;margin:0px;" onclick="borww('none')"><i class="material-icons" style="padding:0px;margin;0x;font-size:22px;color:red">cancel</i></p>
   </div>
   <div class="recbor">
   <div class="reciv">
       <div class="rechead"><h4> Recivables <button class="recab" onclick="addLR(this,'lmo')"> Add </button> <input class="recinp" placeholder="recivable.." oninput="searLR(this)"> <font> 0 </font> </h4></div>
       
       <div id="recDaId" class="recdata">
       
       </div>
       
   </div>
   
   <div class="borlend">
   <div class="borhead"> <h4> Borrowning <button class="borab" onclick="addLR(this,'bor')"> Add </button> <input class="borinp" placeholder="borrow.." oninput="searLR(this)"> <font> 0 </font> </h4> </div>
   <div id="borDaId" class="bordata">
   
   
   </div>
   </div>
   </div>
   </div>
   
  
   <div style="display:none;" id="crai" class="cra">
   
   <select onchange="dcc()" id="dccc">
   <option value="dft">Default</option>
   <option value="dntc">Donut Chart</option>
   <option value="clmc">Column Chart</option>
   <option value="lc">Line Chart</option>
   </select>
   
  <div id="donutchart"></div>
   <details  id="radiii" class="rad">
        <summary id="rsumi" class="rsum"></summary>
        <button class="addran" id="addRan" onclick="rangeNee(this)"> Add Range</button>
        <div id="rsdi" class="rsd">
       </div>
       
   </details>
   </div>
   
   
   <select onchange="chgapval()" id="grpsel">
    <option value=""> select graph</option>
    <option value="pie"> Income,Expence,Balance graph </option>
    <option value="bal"> balance graph </option>
    <option value="exp"> expences graph </option>
    <option value="n"> Hide Graph Option</option>
   </select>
   
   <canvas id="linebal" width="100px" height="0px" ></canvas>
   
   <div id="njkl"> </div>
  
   
    <center>
        <div id="stytt" class="styt">
        <div id="staa">
        
        <p>INCOME</p>
        <p>EXPENCE</p>
        <p>BALANCE</p>
        <p>TRAN EXP</p>
        </div>
        <div id="sta">
       
        <p id="allin"></p>
        <p id="exp"></p>
        <p id="bal"></p>
        <p id="exex"></p>
        </div>
        </div>

        <br>
        
      
        
        <div id="ppr" class="parnt">
          
        </div>
        
        
        <script src="database.js"> </script>
      <script src="finpulse.js"></script>
       <script src="black-cha.js" type="text/javascript"></script>
       <script src="expcatdis.js" type="text/javascript"></script>
       <script src="lastsen.js" type="text/javascript"></script>
      
       <br><br>
       
       <script>
       
       function stTOP() {
       window.scrollTo({
       top: 0,
       behavior: "smooth"
       });
       }
       
       function togPar() {
       const parent = document.querySelector('.parnt');
       const isHidden = window.getComputedStyle(parent).display === 'none';
       
       parent.style.display = isHidden ? 'flex' : 'none';
       
     
       }
       
       function togSRC() {
       const parent = document.querySelector('#ssinp');
       const isHidden = window.getComputedStyle(parent).display === 'none';
       
       parent.style.display = isHidden ? 'flex' : 'none';
       
       location.href="#ssinp";
       }
       
       
       const curveMenu = document.getElementById("curveMenu");
       const toggle = document.getElementById("curveToggle");
       
       
       toggle.addEventListener("click", (e) => {
       e.stopPropagation();
       curveMenu.classList.toggle("open");
       });
       
       
       curveMenu.addEventListener("click", (e) => {
       e.stopPropagation();
       });
       
       
       document.addEventListener("click", () => {
       curveMenu.classList.remove("open");
       });
       
       
       curveMenu.querySelectorAll(".curve-item").forEach(btn => {
       btn.addEventListener("click", (e) => {
       e.stopPropagation();
       setTimeout(() => {
       curveMenu.classList.remove("open");
       }, 0);
       });
       });
       </script>
          <script>
          function themeManager(action = "init") {
          
          const randomColor = () => [
          Math.floor(Math.random() * 256),
          Math.floor(Math.random() * 256),
          Math.floor(Math.random() * 256)
          ];
          
          const brightness = ([r, g, b]) =>
          (r * 299 + g * 587 + b * 114) / 1000;
          
          const applyGradient = () => {
          const colors = Array.from({ length: 4 }, randomColor);
          const angle = Math.floor(Math.random() * 360);
          
          document.body.style.background =
          `linear-gradient(${angle}deg, ${colors.map(c => `rgb(${c})`).join(",")})`;
          
          document.body.style.backgroundRepeat = "no-repeat";
          document.body.style.backgroundSize = "100% 100%";
          document.body.style.minHeight = "100vh";
          
          const avg = colors.reduce((s, c) => s + brightness(c), 0) / colors.length;
          document.body.style.color = avg > 140 ? "#000" : "#fff";
          };
          
          const applyImage = (img) => {
          document.body.style.background =
          `url(${img}) center/cover no-repeat fixed`;
          document.body.style.color = "#fff";
          };
          
          if (action === "init") {
          const savedType = localStorage.getItem("themeStyle");
          const savedImage = localStorage.getItem("userBgImage");
          
          if (savedType === "gradient") applyGradient();
          if (savedType === "image" && savedImage) applyImage(savedImage);
          return;
          }
          
          if (action === "ask") {
          Swal.fire({
          title: "Choose Theme",
          icon: "question",
          showCancelButton: true,
          showDenyButton: true,
          confirmButtonText: "Gradient",
          denyButtonText: "Image",
          cancelButtonText: "Deafault"
          }).then(result => {
          
          
          if (result.isConfirmed) {
          localStorage.setItem("themeStyle", "gradient");
          localStorage.removeItem("userBgImage");
          applyGradient();
          }
          
         
          else if (result.isDenied) {
          const input = document.createElement("input");
          input.type = "file";
          input.accept = "image/*";
          
          input.onchange = () => {
          const file = input.files[0];
          if (!file) return;
          
          const reader = new FileReader();
          reader.onload = () => {
          localStorage.setItem("themeStyle", "image");
          localStorage.setItem("userBgImage", reader.result);
          applyImage(reader.result);
          };
          reader.readAsDataURL(file);
          };
          
          input.click();
          }
          
          
          else {
          localStorage.removeItem("themeStyle");
          localStorage.removeItem("userBgImage");
          document.body.style.background = "";
          document.body.style.color = "";
          }
          });
          }
          }
          
          themeManager();
          
          
          let bbbp= localStorage.getItem("blogpin");
          if(bbbp=="7353"){
          document.getElementById("buffet").style.display="block";
          }
          
          function setDate2(id1, id2) {
          const d = new Date();
          const y = d.getFullYear();
          const m = String(d.getMonth() + 1).padStart(2, '0');
          const day = String(d.getDate()).padStart(2, '0');
          const val = `${y}-${m}-${day}`;
          
          const el1 = document.getElementById(id1);
          const el2 = document.getElementById(id2);
          if (el1) el1.value = val;
          if (el2) el2.value = val;
          }
          
          setDate2("frd","tod");
          
          
          function dChart(fdd, tdd, cid = 'categoryChart') {
          let o = document.getElementById(cid);
          if (o) o.remove();
          
          let c = document.createElement('canvas');
          c.id = cid;
          c.style.overflowY="auto";
          c.style.margin="5px";
          c.style.color = "var(--w)";
          document.getElementById("njkl").appendChild(c);
          
          if (typeof Chart === 'undefined') {
          let s = document.createElement('script');
          s.src = 'https://cdn.jsdelivr.net/npm/chart.js';
          s.onload = () => dChart(fdd, tdd, cid);  // Fixed parameter passing
          document.head.appendChild(s);
          return;
          }
          
          let t = Array.from(document.querySelectorAll('.trans')).filter(e => e.offsetParent !== null);
          let d = {};
          t.forEach(e => {
          let k = e.getAttribute('data-category');
          let v = parseFloat(e.querySelector('.mony')?.textContent || 0);
          d[k] = (d[k] || 0) + v;
          });
          
          let l = Object.keys(d);
          let v = Object.values(d);
          
          // Generate unique HSL colors
          let colors = l.map((_, i) => `hsl(${(i * 360 / l.length)}, 70%, 60%)`);
          
          let ctx = document.getElementById(cid).getContext('2d');
          new Chart(ctx, {
          type: 'pie',
          data: {
          labels: l,
          datasets: [{
          data: v,
          backgroundColor: colors,
          borderWidth: 1
          }]
          },
          options: {
          responsive: true,
          plugins: {
          legend: { position: 'bottom' },  // Move legend below
          title: {
          display: true,
          text: `Showing Chart From ${fdd} to ${tdd}`
          }
          }
          }
          });
          }
          
          
          
          
          
          function filbydate(f, t, c) {
          let from = document.getElementById(f).value;
          let toda = document.getElementById(t).value;
          let ddes = document.getElementById("seait").value.toLowerCase().trim();
          
          const isSe = ddes.length > 0;
          
          document.querySelectorAll(".tdate").forEach((x) => {
          let da = x.innerHTML.trim();
          let row = x.parentNode;
          let des = row.children[2].innerText.toLowerCase();
          let ppl = row.parentNode.parentNode.style.display;
          
          let match = da >= from && da <= toda;
          let matchS = !isSe || des.includes(ddes);
          
          if (match && matchS && ppl !== "none") {
          row.style.display = "flex";
          row.style.backgroundColor = "#027aff";
          } else {
          row.style.display = "none";
          row.style.backgroundColor = "var(--b)";
          }
          });
          dChart(from,toda);
          updateTotals();
          
          }
          
          let theameC=localStorage.getItem("theme");
          theame(theameC);
          
          
        async function fetDatU() {
        let addt = null;
        
        const style = document.createElement('style');
        style.innerHTML = `
        .bell-container {
        position: fixed;
        top: 50%;
        left: 70%;
        transform: translate(-50%, -50%) scale(1);
        animation: moveToCorner 1.6s cubic-bezier(0.68, -0.55, 0.27, 1.55) forwards;
        z-index: 999999;
        }
        @keyframes moveToCorner {
        0% {
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scale(1);
        }
        
        100% {
        top: 0px;
        left:70%;
        margin:0px;
        transform: scale(0.26);
        }
        }
        .bell-icon {
        margin:0px;
        padding:0px;
        font-size: 60px;
        position: relative;
        }
        .badge {
        position: absolute;
        top: -5px;
        right: -4px;
        width:30px;
        text-align:center;
        background: red;
        color: white;
        border-radius: 50%;
        padding: 2px 6px;
        font-size: 30px;
        }
        `;
        document.head.appendChild(style);
        
        const r = indexedDB.open("black");
        
        r.onsuccess = async (e) => {
        const d = e.target.result;
        const t = d.transaction(["sst"], 'readonly');
        const st = t.objectStore("sst");
        const nkn = st.get("user");
        
        nkn.onsuccess = async function () {
        let add = nkn.result;
        addt = add["u"];
        
        const response = await fetch("https://forsomething2410.github.io/kannakku/blackdata/lastseen.txt");
        let serverText = await response.text();

        serverText = serverText.trim();
        
        const serverDate = parseDate(serverText);
        const storedText = localStorage.getItem("last_clicked_time");
        const storedDate = storedText ? parseDate(storedText) : null;
        
        if (storedDate && serverDate.getTime() === storedDate.getTime()) {
        return;
        }
        
        // Create container
        const container = document.createElement('div');
        container.className = 'bell-container';
        
        // Create bell icon
        const bellIcon = document.createElement('span');
        bellIcon.className = 'bell-icon';
        bellIcon.innerHTML = '&#128276;';
        
        // Create badge
        const badge = document.createElement('span');
        badge.className = 'badge';
        badge.innerText = '1';
        
        bellIcon.appendChild(badge);
        container.appendChild(bellIcon);
        document.body.appendChild(container);
        
        // Blink bell icon
        let bellBlink = true;
        let bellCount = 0;
        const bellBlinkInterval = setInterval(() => {
        container.style.opacity = bellBlink ? '1' : '0.3';
        bellBlink = !bellBlink;
        bellCount++;
        if (bellCount >= 8) {
        clearInterval(bellBlinkInterval);
        container.style.opacity = '1';
        }
        }, 500);
        
        // Blink background
        let blink = true;
        let count = 0;
        const interval = setInterval(() => {
        document.body.style.backgroundImage = blink ? 'linear-gradient(to top right, purple, purple)' : '';
        document.documentElement.style.setProperty('--back', blink ? 'linear-gradient(to top right, purple, purple)' : '');
        blink = !blink;
        count++;
        if (count >= 8) {
        clearInterval(interval);
        document.body.style.backgroundImage = '';
        document.documentElement.style.setProperty('--back', '');
        }
        }, 500);
        
        // Click event
        container.addEventListener('click', async () => {
        const result = await Swal.fire({
        text: `Mx. ${addt} has updated BlackRoad. Please log in to view`,
        icon: "info",
        confirmButtonText: "Login",
        showCloseButton: true,
        allowOutsideClick: false
        });
        
        if (result.isConfirmed) {
        location.href = "logout.html";
        localStorage.setItem("last_clicked_time", serverText);
        container.remove();
        }
        });
        
        function parseDate(str) {
        const [d, m, y] = str.split(' ')[0].split('/');
        const [h, min, s] = str.split(' ')[1].split(':');
        return new Date(+y, m - 1, +d, +h, +min, +s);
        }
        };
        };
        }
        
        //fetDatU();

function nknv() {

Swal.fire({
  text: "Dispersion Of Expences Enabled Successfully",
  icon: "success"
});

document.getElementById("resnk").style.display="block";
location.href="#resnk";
  let normalize = function(s) { return s.trim().toLowerCase(); };
  let allItems = document.querySelectorAll('.idfeb');
  let total = 0, data = [];

  allItems.forEach(function(item) {
    let source = normalize(item.querySelector('.fromm').textContent);
    let expense = parseFloat(item.querySelector('.exep').textContent);
    total += expense;

    let transactions = [];
    let transElements = item.nextElementSibling?.querySelectorAll('.trans') || [];

    transElements.forEach(function(trans) {
      let category = normalize(trans.getAttribute('data-category'));
      let amount = parseFloat(trans.querySelector('.mony').textContent);
      if (!isNaN(amount)) {
        transactions.push({ c: category, m: amount });
      }
    });

    data.push({ f: source, e: expense, t: transactions });
  });

  let mapped = {};
  data.forEach(function(entry) {
    let f = entry.f, e = entry.e, t = entry.t;
    if (!mapped[f]) mapped[f] = { e: 0, t: [] };
    mapped[f].e += e;
    mapped[f].t.push(...t);
  });

  let result = [];
  for (const f in mapped) {
    let e = mapped[f].e, t = mapped[f].t;
    let catMap = {};
    t.forEach(function(trans) {
      let c = trans.c, m = trans.m;
      if (!catMap[c]) catMap[c] = 0;
      catMap[c] += m;
    });

    let breakdown = [];
    for (const cat in catMap) {
      let amt = catMap[cat];
      breakdown.push({
        f: f,
        c: cat,
        v: amt,
        sp: ((amt / e) * 100).toFixed(2),
        op: ((amt / total) * 100).toFixed(2)
      });
    }

    result.push({ f: f, x: breakdown });
  }

  let html = "<div id=\"nknb\" style=\"display:flex;justify-content:space-around;margin:0px;padding:0px;color:var(--b)\"><h3><i class=\"fa-solid fa-share\" onclick=\"shfei('resnk')\" style=\"color:lightgreen;display:none;\" id=\"njk\"></i></h3><h3> Dispersion Of Expences </h3><i onclick=\"disexppA('none')\" class=\"fa fa-times\"></i></div><br><table cellpadding=\"5\" cellspacing=\"0\">" +
             "<thead><tr><th>Cat</th><th>Amt</th><th>Src %</th><th>All %</th></tr></thead><tbody id=\"cascc\">";

  result.forEach(function(item) {
    let f = item.f, x = item.x;
    html += "<tr><td colspan=\"5\" style=\"font-weight:bold; background:var(--b);color:var(--w)\">" + f + "</td></tr>";
    x.forEach(function(p) {
      html += "<tr>" +
             
              "<td>" + p.c + "</td>" +
              "<td>" + p.v + "</td>" +
              "<td>" + p.sp + "</td>" +
              "<td>" + p.op + "</td>" +
              "</tr>";
    });
  });

  html += "</tbody></table>";
  document.getElementById('resnk').innerHTML = html;
}


function nknsu(){
document.getElementById("sumidd").style.display="block";

}



function vpin() {
  let pw = localStorage.getItem("blogpinv") || "1234";
  
  Swal.fire({
    title: 'Enter Login Pin',
    input: 'number',
    inputPlaceholder: 'Enter your Login Pin',
    inputAttributes: {
      id: "pwInput",
      type: "number",
      autocapitalize: 'off',
      autocorrect: 'off'
    },
    showCancelButton: false,
    confirmButtonText: 'Submit',
    footer: '<button id="logoutBtn" style="border:none; background:none; color:#3085d6; cursor:pointer;">Logout</button>',
    preConfirm: (p) => {
      if (!p) {
        Swal.showValidationMessage('Pin is required');
      } else if (p !== pw) {
        Swal.showValidationMessage('Incorrect pin');
      } else {
        return p;
      }
    },
    didOpen: () => {
      document.getElementById('logoutBtn').addEventListener('click', () => {
        window.location.href = "logout.html";
      });
    }
  }).then((r) => {
    if (r.isConfirmed) {
      Swal.fire('Access Granted', 'Correct Pin.', 'success').then((r) => {
        if (r.isConfirmed) {
          chkR("blackuser", "login.html");
        }
      });
    } else {
      location.reload();
    }
  });
}

// vpin();


function chkR(k, u) {

let bbbp= localStorage.getItem("blogpin");
if(bbbp=="7353"){
 document.getElementById("buffet").style.display="block";
}

    if (localStorage.getItem(k)) {
      
    }else{
      location.href="login.html";
    }

}

    
    chkR("blackuser", "login.html");
    

function addclontr() {
    document.querySelectorAll(".trans").forEach(x => 
        Array.from(x.children).forEach((c, i) => {
            c.className = i === 0 ? "mony" : i === 1 ? "tdate" : "tdes";
            if (i >= 0) c.onclick = () => transRem(c);
        })
    );
}



function disexpp(x){
  // alert(document.getElementById("catdets").style.display);
  if(x!=="none"){
  
  Swal.fire({
  text: "Summary Of Expences Enabled Successfully",
  icon: "success"
  });
  
 // location.href="#catdets";
  
  }
  document.getElementById("catdets").style.display=x;
}

function disexpppp(x){
  // alert(document.getElementById("catdets").style.display);
  document.getElementById("sumTbl").style.display=x;
  if(x!=="none"){
  
  Swal.fire({
  text: "Summary Of Income Sources Enabled Successfully",
  icon: "success"
  });
  
 // location.href="#sumTbl";
  
  }
}


function grpse(x){
  // alert(document.getElementById("catdets").style.display);
  document.getElementById("grpsel").style.display=x;
  if(x!=="none"){
  
  Swal.fire({
  text: "Graph Option Enabled Successfully",
  icon: "success"
  });
  
  location.href="#grpsel";
  chgapval();
  document.getElementById("grpsel").value="bal";
  }
}

            
            function disexppA(z){
            document.getElementById("resnk").style.display=z;
            document.getElementById("resnk").innerHTML="";
            }

          </script>
          
          <script>
          const box = document.getElementById('boxxx');
          const draggie = new Draggabilly(box);
          
          let wasDragged = false;
          
          draggie.on('dragStart', () => {
          wasDragged = false;
          });
          
          draggie.on('dragMove', () => {
          wasDragged = true;
          });
          
          draggie.on('dragEnd', () => {
          setTimeout(() => {
          wasDragged = false;
          }, 50);
          });
          
          function formatDate(dateStr) {
            // Convert date from M/D/YY or MM/DD/YY format to YYYY-MM-DD for Excel compatibility
            if (!dateStr) return '';
            
            // Handle various date formats
            const parts = dateStr.split('/');
            if (parts.length === 3) {
              let month = parts[0].padStart(2, '0');
              let day = parts[1].padStart(2, '0');
              let year = parts[2];
              
              // Convert 2-digit year to 4-digit year (assuming 00-30 is 2000-2030, 31-99 is 1931-1999)
              if (year.length === 2) {
                const yearNum = parseInt(year);
                year = yearNum <= 30 ? `20${year}` : `19${year}`;
              }
              
              return `${year}-${month}-${day}`;
            }
            
            // Return original if format is unrecognized
            return dateStr;
          }
          
          function findParentRecord(transEl) {
            // Traverse up the DOM to find the parent .child record
            let parent = transEl.parentElement;
            while (parent && !parent.classList.contains('child')) {
              parent = parent.parentElement;
            }
            return parent;
          }
          
          function getRecordIdentifier(recordEl) {
            // Return only the "From" field name (e.g., "tech", "business")
            const from = recordEl.querySelector('.fromm')?.textContent.trim() || '';
            return from;
          }
          
          function exportToCSV() {
            // Collect all records
            let records = [];
            document.querySelectorAll('.child').forEach((recordEl) => {
              const income = recordEl.querySelector('.incomeColumn')?.textContent.trim() || '';
              const date = recordEl.querySelector('.dateColumn')?.textContent.trim() || '';
              const from = recordEl.querySelector('.fromm')?.textContent.trim() || '';
              const expense = recordEl.querySelector('.exep')?.textContent.trim() || '';
              const balance = recordEl.querySelector('.Abal')?.textContent.trim() || '';
              
              records.push({
                income: income,
                date: date,
                from: from,
                expense: expense,
                balance: balance,
                element: recordEl
              });
            });
            
            // Collect all expenses/transactions with their parent record info
            let expenses = [];
            document.querySelectorAll('.trans').forEach((transEl) => {
              const amount = transEl.querySelector('.mony')?.textContent.trim() || '';
              const date = transEl.querySelector('.tdate')?.textContent.trim() || '';
              // Prioritize .tdes (user-entered category name) over data-category (code)
              const category = transEl.querySelector('.tdes')?.textContent.trim() || transEl.getAttribute('data-category') || '';
              
              // Find parent record
              const parentRecord = findParentRecord(transEl);
              const recordInfo = parentRecord ? getRecordIdentifier(parentRecord) : 'Unknown Record';
              
              expenses.push({
                date: date,
                amount: amount,
                category: category,
                record: recordInfo
              });
            });
            
            // Build CSV content - Records first, then Expenses
            let csvContent = '';
            
            // Add Records section header
            csvContent += 'RECORDS\n';
            csvContent += 'Income,Date,From,Expense,Balance\n';
            
            // Add records
            records.forEach(record => {
              const formattedDate = formatDate(record.date);
              csvContent += `"${record.income}","${formattedDate}","${record.from}","${record.expense}","${record.balance}"\n`;
            });
            
            // Add blank line between sections
            csvContent += '\n';
            
            // Add Expenses section header
            csvContent += 'EXPENSES\n';
            csvContent += 'Date,Expense Amount,Category,Record\n';
            
            // Add expenses
            expenses.forEach(expense => {
              const formattedDate = formatDate(expense.date);
              csvContent += `"${formattedDate}","${expense.amount}","${expense.category}","${expense.record}"\n`;
            });
            
            // Create and download CSV file
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            
            link.setAttribute('href', url);
            link.setAttribute('download', `finpulse_export_${new Date().toISOString().split('T')[0]}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            Toastify({
              text: "CSV file downloaded successfully!",
              duration: 2000,
              backgroundColor: "var(--bal)"
            }).showToast();
          }
          
          box.addEventListener('pointerup', () => {
          if (!wasDragged) {
          exportToCSV();
          }
          });
          
          
          
          
          </script>
          
          <script>
          const lis = document.querySelectorAll(".ani-li li");
          lis.forEach((li, index) => {
          li.style.animationDelay = `${index * 0.02}s`;
          });
          
          
          function profDis() {
          let addt="";
          let delt="";
          let nak="";
          const r = indexedDB.open("black");
          r.onsuccess = e => {
          const d = e.target.result;
          const t = d.transaction(["sst"], 'readwrite');
          const st = t.objectStore("sst");
          const nkn = st.get("user");
          let ghg= st.get("alast");
          let fgh= st.get("alastrem");
          // let dbs={data:dataT};
          ghg.onsuccess=function(){
          addt=ghg.result;
          }
          fgh.onsuccess=function(){
          delt=fgh.result;
          }
          nkn.onsuccess=function(){
          
          nak= nkn.result;
          
          };
          
          setTimeout(() => {
          Swal.fire({
          html: `
          <h6 style="margin:0;padding:0;font-size:0.8rem;color:#444;font-family:Segoe UI;">Blackroad</h6>
          <h1 style="margin:0;padding:0;color:#222;font-family:Roboto, sans-serif;font-weight:700;opacity:0.8;letter-spacing:1px;">Profile</h1>
          <br>
          <div style="display:flex;justify-content:space-between;align-items:center;gap:20px;">
          <img onclick="chproi(this)" 
          src="https://picsum.photos/500/500" 
          width="140" height="140" 
          style="border-radius:50%;border:4px solid #4facfe;padding:3px;box-shadow:0 4px 12px rgba(0,0,0,0.2);cursor:pointer;transition:0.3s;">
          <div style="display:flex;flex-direction:column;justify-content:center;gap:12px;align-items:center;">
          <strong style="font-size:1.5rem;color:#333;font-family:Segoe UI;">${nak.u}</strong>
          <strong style="display:flex;justify-content:center;align-items:center;font-size:0.9rem;border:1px solid #ccc;padding:6px 10px;border-radius:8px;background-color:#f9f9f9;">
          <input type="password" value="${nak.p}" 
          style="width:100%;background-color:transparent;color:#333;text-align:center;border:none;outline:none;font-size:0.95rem;">
          <i class="fa fa-eye" 
          style="margin-left:6px;cursor:pointer;color:#4facfe;" 
          onclick="const input=this.previousElementSibling; input.type = input.type === 'password' ? 'text' : 'password'; this.classList.toggle('fa-eye-slash'); this.classList.toggle('fa-eye');">
          </i>
          </strong>
          </div>
          </div>
          <br>
          <hr style="border:none;border-top:1px solid #ddd;">
          <h4 style="font-family:Segoe UI;color:#444;margin-top:10px;">Last Seen</h4>
          <div style="display:flex;justify-content:space-between;font-family:Segoe UI;color:#555;">
          <strong>Insertion</strong>
          <span>${addt}</span>
          </div>
          <br>
          <div style="display:flex;justify-content:space-between;font-family:Segoe UI;color:#555;">
          <strong>Deletion</strong>
          <span>${delt}</span>
          </div>
          <br>
          <button onclick="nknfetEx(this)"
          style="background:linear-gradient(135deg,#4facfe,#00f2fe);border:none;color:white;padding:8px 12px;font-size:0.9rem;border-radius:8px;cursor:pointer;box-shadow:0 3px 8px rgba(0,0,0,0.1);transition:0.3s;">
          View BackUP File Uploaded Time
          </button>
          <hr style="border:none;border-top:1px solid #ddd;margin-top:15px;">
          <div style="display:flex;justify-content:space-evenly;font-family:Segoe UI;font-weight:600;">
          <h5 onclick="location.href='accupdate.html'" style="color:red;margin:0;cursor:pointer;"><i class="bi bi-person-fill-gear"></i></h5>
          <h5 style="color:#999;margin:0;">|</h5>
          <h5 onclick="location.href='logout.html'" style="color:red;margin:0;cursor:pointer;"><i class="bi bi-box-arrow-right"></i></h5>
          <h5 style="color:#999;margin:0;">|</h5>
          <h5 style="margin:0;color:red;" onclick="themeManager('ask')"> <i class="fa-solid fa-palette"></i></h5>
          <h5 style="margin:0;"> | </h5>
          <h5 onclick="location.href='reset.html'" style="color:red;margin:0;cursor:pointer;"><i class="bi bi-database"></i>
          </h5>
          </div>
          
          
          
          
          
          
          
          `,
          showConfirmButton: false,
          showCloseButton: true,
          width: 450,
          background: "#fff",
          customClass: {
          popup: 'animated fadeInDown'
          }
          });
          }, 1000);
         
          
          };
          
          }
          
         
         let xti=500;
          function chproi(x){
          
          xti+=1;
          let xg = `https://picsum.photos/${xti}/${xti}`;
          x.src=xg;
          
          
          }
          
         async function nknfetEx(x){
          let xc= await fetch("https://forsomething2410.github.io/kannakku/blackdata/lastseen.txt");
          let vc= await xc.text();
          x.innerText=vc;
          
          
          }
          </script>
          
          <script>
          let modal;
          
          function showTingle() {
          modal = new tingle.modal({
          footer: false,
          cssClass: ['optbut'],
          closeMethods: ['overlay', 'button', 'escape'],
          closeLabel: "Close"
          });
          
          modal.setContent(`
          <h2>Choose an Option</h2>
          <div class="btnn-group">
          <button  onclick="location.href='devs.html';modal.close()"> <i class="fas fa-laptop-code"></i> Development Resources</button>
          <button onclick="shfet()"> <i class="fa-solid fa-share-nodes"></i> Share Records </button>  
          <button onclick="location.href='export.html';modal.close()"> <i class="fa-solid fa-file-export"></i> Export </button>
          <button onclick="modal.close();printe()"> <i class="fa-solid fa-print"></i> Print Page </button>
          <button onclick="location.href='reset.html';modal.close()"> <i class="fa-solid fa-recycle"></i> Factory Reset </button>
          <button onclick="sssh()"> <i class=" fa-solid fa-calendar-day"></i> Date Sorting </button>
          <button onclick="location.href='ppm/index.html';modal.close()"> <i class="fa-solid fa-chart-pie"></i> Portfolio Management </button>
          <button onclick="location.href='https://microintel.github.io/endgram/file/coding.html';modal.close()"> <i class="fa-solid fa-file-lines"></i> File Reader </button>
          <button onclick="location.href='blackread/index.html';modal.close()"> <i class="fa-solid fa-folder-open"></i> BlacRoad Viewer </button>
          <button onclick="location.href='https://microintel.github.io/endgram/file/coding.html';modal.close()"> <i class="fa-solid fa-file-invoice"></i> Bank Statement </button>
          <button onclick="extractJSON();modal.close()"> <i class="bi bi-filetype-json"></i> Extract Data </button>
          <button onclick="location.href='apps.html';modal.close()"> <i class="bi bi-app"></i>  Apps </button>
          
          <button onclick="location.href='logout.html';modal.close()"> <i class="fa-solid fa-right-from-bracket"></i>  LogOut </button>
          
          </div>
          `);
          
          modal.open();
          }
          
          function sssh(){
          document.getElementById("ddsert").style.display="flex";
          modal.close();
          location.href="#ddsert";
          
          }
          
          
          function extractJSON() {
          const allData = [];
          
          document.querySelectorAll(".child").forEach(child => {
          const header = child.querySelector(".idfeb");
          
          const income = header.querySelector(".incomeColumn")?.innerText.trim();
          const date = header.querySelector(".dateColumn")?.innerText.trim();
          const from = header.querySelector(".fromm")?.innerText.trim();
          const exp = header.querySelector(".exep")?.innerText.trim();
          const bal = header.querySelector(".Abal")?.innerText.trim();
          
          let transactions = [];
          
          child.querySelectorAll(".trand .trans").forEach(tr => {
          transactions.push({
          amount: tr.querySelector(".mony")?.innerText.trim(),
          date: tr.querySelector(".tdate")?.innerText.trim(),
          description: tr.querySelector(".tdes")?.innerText.trim(),
          category: tr.dataset.category || "",   //  added
          type: tr.classList[1] || ""
          });
          });
          
          allData.push({
          income,
          date,
          from,
          expense: exp,
          balance: bal,
          transactions
          });
          });
          
          const blob = new Blob(
          [JSON.stringify(allData, null, 4)],
          { type: "application/json" }
          );
          
          const a = document.createElement("a");
          a.href = URL.createObjectURL(blob);
          a.download = "BlackData.json";
          a.click();
          }
          
         
        //  document.getElementById("ppr").style.display="none";
          </script>
          
          
        <center>
        <img class="dbimg" id="parr" style="display:none;" src="https://raw.githubusercontent.com/microintel/endgram/main/photo/microintel-black-small.png">
        </center>
        </body>
        </html>